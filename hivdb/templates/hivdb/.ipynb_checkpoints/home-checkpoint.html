{% extends "hivdb/base.html" %}
{% load static %}

{% block title %}
        <title>HIVSeqDB | Home</title>
{% endblock %}

{% load leaflet_tags %}
{% block top_js %}
    {% leaflet_js %}
    <script src="{% static "hivdb/custom/js/highcharts/highcharts.js" %}"></script>
    <script src="{% static "hivdb/custom/js/highcharts/exporting.js" %}"></script>
    <script src="{% static "hivdb/custom/js/highcharts/export-data.js" %}"></script>
    <script src="{% static "hivdb/custom/js/highcharts/jquery.min.js" %}"></script>
{% endblock %}

{% block css %}
    {% leaflet_css %}   
    <style>
    .leaflet-container { 
        width:  100%;
        height: 700px;
    }
    .container-charts {
          display: grid;
          width: 100%;
          margin: auto;
          padding: 25px 0px;
          grid-column-gap: 0px;
          grid-row-gap:0px;
          grid-template-columns: 1fr 1fr  ;
          grid-template-areas: "container trends" 
                               "container trends"
    }
    .container {
      grid-area: container;
    }
    .trends {
      grid-area: trends;
      height: 700px;
    }
        
.grid-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 20px;
    margin: auto;
    text-align: center;
    padding-top: 0px;
    padding-bottom: 0px;

}
.grid-item {
    background-color:  rgba(216, 219, 228, 0.664); /*rgb(230, 234, 236);/*linear-gradient(blue,green);*/
    color: black;
    padding: 2em;
/*     border-radius: 20px; */
}
    
    .grid-item h3 {
        font-size: 25px;
    }
    
    .grid.item p {
        font-size: 20px;
    }

.button {
  background-color:#2980b9; /* rgb(6, 108, 224); /* Green */ */
  border: none;
  color: white;
  padding: 10px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
/*   border-radius: 20px; */
}
    
    
    .left {
        float:left;
    }
    
    .right {
        float:right;
    }
    
    /* Slideshow container */
.slideshow-container {
  max-width: 100%;
  position: relative;
  margin: auto;
  background-color:#F0F0F0;
  padding: 20px;
}
/* Next & previous buttons */
.prev, .next {
  cursor: pointer;
  position: relative;
  top: 50%;
  width: auto;
  padding: 16px;
  margin-top: -22px;
  color: white;
  font-weight: bold;
  font-size: 18px;
  transition: 0.6s ease;
  border-radius: 0 3px 3px 0;
  user-select: none;
}

/* Position the "next button" to the right */
.next {
  right: 0;
  border-radius: 3px 0 0 3px;
}

/* On hover, add a black background color with a little bit see-through */
.prev:hover, .next:hover {
  background-color: rgba(0,0,0,0.8);
}

/* Caption text */
.text {
  color: #f2f2f2;
  font-size: 15px;
  padding: 8px 12px;
  position: absolute;
  bottom: 8px;
  width: 100%;
  text-align: center;
}

/* Number text (1/3 etc) */
.numbertext {
  color: #f2f2f2;
  font-size: 12px;
  padding: 8px 12px;
  position: absolute;
  top: 0;
}

/* The dots/bullets/indicators */
.dot {
  cursor: pointer;
  height: 15px;
  width: 15px;
  margin: 0 2px;
  background-color: #bbb;
  border-radius: 50%;
  display: inline-block;
  transition: background-color 0.6s ease;
}

.active, .dot:hover {
  background-color: #717171;
}

/* Fading animation */
.fade {
  animation-name: fade;
  animation-duration: 1.5s;
}

@keyframes fade {
  from {opacity: .4} 
  to {opacity: 1}
}
    
    
    .slide-text{
        padding: 20px;
    }
    
    .slide-text h3{
        font-size:25px;
    }
    
    .slide-text p{
        font-size:20px;
    }
</style>
{% endblock %}

{% block content %}

<section>
    <div class="slideshow-container" align="center">

<div class="mySlides fade">
  <div class="numbertext">1 / 4</div>
    <div class="slide-text">
    <h3>About the database</h3>
    <p>
        UVRIseq Database integrates sequence data and associated
        demographics and clinical data. It is manually curated and
        updated per month by a dedicated team at the UVRI. 
        Follow the link below to learn more about the collection,
        storage, privacy and data sharing policy of UVRIseq.
    </p>
    <a href="#" class="button">Read more</a> 
    </div>
</div>

<div class="mySlides fade" align="center">
  <div class="numbertext">2 / 4</div>
    <div class="slide-text">
    <h3>Data summary</h3>
                <p>
                Currently UVRIseq contains information of about 10,000
                HIV consensus sequences generated using Sanger sequencing,
                5,000 near full length HIV sequences generated using NGS platforms.
                Data is available from five major regions of Uganda including; East, Central,
                North, Kampala and nothern Uganda.  
                </p>
                <a href="#" class="button">Read more</a>
    </div>
    </div>
<div class="mySlides fade" align="center">
  <div class="numbertext">3 / 4</div>
        <div class="slide-text">
                <h3>Analyses</h3>
                <p>
                    The UVRIseq team mantains a set of inhouse pipelines that are used
                    to conduct analyses such as HIV drug resistance
                    and transmission network analyses. 
                    These pipelines are accessible via a web server 
                    but commandline versions are available upon reasonable request.
                </p>
                <a href="#" class="button">Read more</a>
    </div>
</div>

<div class="mySlides fade" align="center">
  <div class="numbertext">3 / 4</div>
        <div class="slide-text">
                <h3>Research</h3>
                <p>
                    The UVRIseq team mantains a set of inhouse pipelines that are used
                    to conduct analyses such as HIV drug resistance
                    and transmission network analyses. 
                    These pipelines are accessible via a web server 
                    but commandline versions are available upon reasonable request.
                </p>
                <a href="#" class="button">Read more</a>
    </div>
</div>

        
<!-- <a class="prev" onclick="plusSlides(-1)">❮</a>
<a class="next" onclick="plusSlides(1)">❯</a>
 -->
        
</div>
<br>

<div style="text-align:center">
  <span class="dot" onclick="currentSlide(1)"></span> 
  <span class="dot" onclick="currentSlide(2)"></span> 
  <span class="dot" onclick="currentSlide(3)"></span> 
  <span class="dot" onclick="currentSlide(4)"></span> 
</div>
</section>


<section>    
<div class="container-charts">
        <div class="container" id='container'>
            <div>
                {% leaflet_map "main" callback="map_init" %}
            </div>
        </div>
        <div class="trends" id='trends'></div>
</div>
</section>
{% endblock %}  

{% block js %}
<script>
let slideIndex = 1;
showSlides(slideIndex);

function plusSlides(n) {
  showSlides(slideIndex += n);
}

function currentSlide(n) {
  showSlides(slideIndex = n);
}

function showSlides(n) {
  let i;
  let slides = document.getElementsByClassName("mySlides");
  let dots = document.getElementsByClassName("dot");
  if (n > slides.length) {slideIndex = 1}    
  if (n < 1) {slideIndex = slides.length}
  for (i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";  
  }
  for (i = 0; i < dots.length; i++) {
    dots[i].className = dots[i].className.replace(" active", "");
  }
  slides[slideIndex-1].style.display = "block";  
  dots[slideIndex-1].className += " active";
}
</script>


<script type="text/javascript">
		function map_init(map, options){
            map.setView([1.3733, 32.2903], 7); //1.3733, 32.2903
            //add first marker on map
            var mubende = L.marker([0.5539, 31.3885]);
			var list = "<Strong>No. sequences: </Strong>" + 120 + "<br />"
					  + "<Strong>Prevalence of ADR: </Strong>" + "5%" + "<br />";
			mubende.bindPopup(list).addTo(map);
            
            //add second marker on map
            var lira = L.marker([2.2581, 32.8874]);
			lira.bindPopup(list).addTo(map);
            
            //add third marker on map
            var kampala = L.marker([0.3476, 32.5825]);
			kampala.bindPopup(list).addTo(map);
            
            //disable zoom control
            map.removeControl(map.zoomControl);
		}
</script>
    
    
<script>
  Highcharts.chart('trends', {
  chart: {
    type: 'areaspline'
  },
  title: {
    text: 'Sequences generated by different platforms over the years'
  },
  legend: {
    layout: 'vertical',
    align: 'left',
    verticalAlign: 'top',
    x: 150,
    y: 100,
    floating: true,
    borderWidth: 1,
    backgroundColor:
      Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF'
  },
  xAxis: {
    categories: [
      '2012',
      '2013',
      '2014',
      '2015',
      '2016',
      '2017',
      '2018',
      '2019',
      '2020',
      '2021'
    ]
  },
  yAxis: {
    title: {
      text: 'Number of sequences'
    }
  },
  tooltip: {
    shared: true,
    valueSuffix: ' units'
  },
  credits: {
    enabled: false
  },
  plotOptions: {
    areaspline: {
      fillOpacity: 0.5
    }
  },
  series: [{
    name: 'Sanger',
    data: [3, 4, 3, 5, 4, 10, 12, 20, 25, 27]
  }, {
    name: 'Illumina-Miseq',
    data: [0, 0, 4, 3, 3, 5, 4, 12, 24, 35]
  }, {
    name: 'Oxford Nanopore',
    data: [0, 0, 0, 0, 1, 2, 3, 10, 13, 18]
  }]
});
</script>
{% endblock %}